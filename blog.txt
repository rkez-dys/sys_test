初めての「Azure Cosmos DB」：RDBMSとの違いから学んだこと

今回参画した案件で、初めて Azure Cosmos DB を使用する機会がありました。それまでは SQL Server などのリレーショナルデータベース（RDBMS）を主に扱っていたため、同じ感覚で触れようとすると戸惑う部分が多く、「考え方を切り替えること」が重要だと感じました。本記事では、実際に触れて理解した Cosmos DB と RDBMS の違いをまとめます。

■ Cosmos DBとは？

Azure Cosmos DBは、グローバル分散型のNoSQLデータベースサービス です。
スキーマレスで柔軟にデータを保存できること、スケール性能が高いことが大きな特徴です。

■ RDBMSとの主な違い
観点	RDBMS（SQL Server等）	Cosmos DB
データ構造	テーブル・行・列（固定スキーマ）	JSONドキュメント（スキーマレス）
クエリ言語	SQL	SQLライクだが制約あり
スケール	垂直スケール中心	自動的な水平スケールが前提
データ整合性	強整合性が基本	整合性レベルを選択可能
コスト	サーバーリソース課金	RU（リクエストユニット）課金

最も驚いたのは、スキーマを定義しなくてよいこと でした。
その反面、アプリケーション側でデータ構造をきちんと意識しないと、ドキュメントの形が乱れやすくなります。

また、Cosmos DBは RU（Request Unit） という概念でコストが発生します。
つまり、クエリが複雑だったり、ドキュメントサイズが大きいと 直接コストが上がります。
設計時点から「いかに軽いクエリで済むようにするか」を意識する必要がある点は、RDBとは異なるポイントでした。

■ 使って感じたメリット

スキーマ変更の柔軟さは非常に便利

グローバルレプリケーションによる高い可用性

アプリ開発においてフロントエンドと相性が良い（データ形式がJSONのため）

■ 逆に難しかった点

RU設計や最適化の必要性

Partition Key の選定がシステム全体に影響する

SQLと似ているが、同じとは思わない方がよい

■まとめ

Cosmos DBは、RDBMSと同じ考え方で使おうとすると戸惑いますが、「ドキュメント単位でデータを扱う」 というNoSQLの前提を理解すると、強力で柔軟なデータベースであると感じました。
今後は、Partition Key 設計やRU効率を考えたクエリ最適化 をより深く学び、実案件で活かしていきたいと思います。